ang.factory("CrudPlugin", [function () { var a = { Crud: { CrudPLugin: { Init: function () { return new Promise(function (a, b) { var c = null; document.addEventListener("deviceready", function () { try { c = window.sqlitePlugin.openDatabase({ name: "gurps.db", location: "default" }), c ? a(c) : b({ erro: "Sqllite não instanciado" }) } catch (a) { b(a.message) } }) }) } }, ExecuteQueryConsulta: function (b) { var c = new Promise(function (c, d) { var e = []; a.Crud.CrudPLugin.Init().then(function (a) { a.transaction(function (a) { a.executeSql(b.query, b.args, function (a, b) { if (b.rows.length > 0) { try { for (var f = 0; f < b.rows.length; f++) { var g = JSON.parse(b.rows.item(f).data); g.id = b.rows.item(f).id, e.push(g) } } catch (a) { d(a) } c(e) } else c([]) }) }) }) }); return c } } }; return a }]);